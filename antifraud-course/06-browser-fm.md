# 06. Browser FM (Future Model)

**Автор:** Вектор Т13
**Длительность:** ~17 минут
**Уровень:** Продвинутый
**Тип урока:** Новейшая технология fingerprinting (2025)

---

## Краткое содержание

Browser FM (Future Model) - самый большой из существующих браузерных отпечатков. Собирает 16,000 параметров с ПК, использует Fuzzy Hashing для устойчивости к изменениям. Точность идентификации: 99.7%. Данные хранятся в 9 раз компактнее, чем JSON.

---

## Ключевые тезисы

### 1. Характеристики Browser FM

| Параметр | Значение |
|----------|----------|
| Количество атрибутов | ~16,000 |
| Точность идентификации | 99.7% |
| Устойчивость к изменениям | До 30% |
| Компактность хранения | 9x меньше JSON |

### 2. Что собирается

- Window (размер окна, DPI)
- Navigator (браузер, языки)
- Screen (разрешение)
- Performance (~37 метрик)
- CSS
- GPU
- Fonts (шрифты)
- Extensions (расширения)

### 3. Главная особенность

**Fuzzy Hashing** - игнорирует до 30% изменений. Изменение одного параметра (DPI, размер окна) НЕ создаёт новый отпечаток.

---

## Полный конспект

### Что такое Browser FM

**FM = Future Model** (не радио)

- Самый большой браузерный отпечаток на 2025 год
- Представлен летом 2025
- Использует BOM-энумерацию (Browser Object Model)

### Архитектура

#### Сбор данных

Классы для энумерации:
- Window
- Navigator
- Screen
- Performance
- CSS
- GPU

#### Построение дерева

```
Browser FM
├── Window (размер, DPI, ...)
├── Navigator (UA, языки, ...)
├── Screen (разрешение, ...)
├── Performance (22 основных + 15 доп. метрик)
├── CSS (стили, ...)
├── GPU (видеокарта, ...)
├── Fonts (шрифты)
└── Extensions (расширения)
```

#### Fuzzy Hashing

Два отпечатка для каждого пользователя:
1. **Полный** - все 16,000 параметров
2. **Fuzzy** - устойчивый к изменениям (30% tolerance)

### Преимущества для бизнеса

| Преимущество | Описание |
|--------------|----------|
| Компактность | 9x меньше JSON |
| Масштаб | Amazon/Google - сотни миллионов/день |
| Экономия | Огромная экономия хранения |
| Расширяемость | Новые API автоматически добавляются |

### Сегментированный поиск

Browser FM может **игнорировать ветви** при поиске:

| Сценарий | Поведение |
|----------|-----------|
| Замена видеокарты | Найдёт, игнорируя GPU branch |
| Новый ПК | Определит как нового пользователя |
| Переустановка ОС | Обнаружит |
| Обновление браузера | Учтёт изменения |

### Что детектирует

1. **Свежеустановленные VPS/серверы**
   - Чистая ОС = мало шрифтов/расширений
   - Windows Server определяется

2. **Виртуальные машины**
   - Определяются "великолепнейшим образом"

3. **Антидетект-браузеры**
   - Также детектируются

4. **Подмена User-Agent**
   - Полностью бесполезна с 2017 года

### Шрифты как маркер

#### Чистая машина
- Только системные шрифты
- Определяется как "новая"

#### Реальная машина
- Шрифты от Microsoft Office
- Шрифты от Adobe
- Другое ПО

**Рекомендация:** Установка дополнительных шрифтов помогает обойти метрики.

### Расширения браузера

**Важно:** Использование AdBlock/uBlock **рекомендуется**!

Это признак реального пользователя:
- Редко где нет блокировщика рекламы
- Отсутствие = подозрительно

### Мобильные устройства

Browser FM особенно эффективен на мобильных:
- Унификация железа не спасает
- Android позволяет детект без установки ПО
- Мобильные браузеры отстают от desktop

### Веса веток

Не все ветки равны:

| Ветка | Вес | Причина |
|-------|-----|---------|
| Performance | Высокий | Сложно подделать |
| GPU | Высокий | Аппаратный |
| Window | Низкий | Легко изменить |
| Navigator | Низкий | Легко изменить |

---

## Технические детали

### BOM Enumeration

```javascript
// Примерные классы для сбора
Window -> size, DPI, features
Navigator -> UA, languages, plugins
Screen -> resolution, colorDepth
Performance -> timing, memory, entries
CSS -> supports, media queries
GPU -> renderer, vendor, extensions
```

### Fuzzy Hashing

```
Full Hash: SHA256(all_16000_params)
Fuzzy Hash: SimHash(ignore_30%_changes)

// Поиск по обоим:
if (full_hash_match OR fuzzy_hash_match) {
    return same_user;
}
```

### Структура данных

```
Feature Model Tree
├── Branch: Window (weight: 0.3)
│   ├── innerWidth
│   ├── innerHeight
│   └── devicePixelRatio
├── Branch: Performance (weight: 1.0)
│   ├── memory
│   ├── timing
│   └── ...22 более параметров
└── Branch: GPU (weight: 0.9)
    ├── renderer
    └── vendor
```

---

## Рекомендации

### Что делать

1. **Установить Microsoft Office** - добавляет шрифты
2. **Установить AdBlock/uBlock** - признак реального пользователя
3. **Использовать реальную машину** - не VPS/VM
4. **Избегать Windows Server** - ставьте Home/Pro

### Чего избегать

1. **Подмена User-Agent** - бесполезна
2. **Свежеустановленные ОС** - детектируются
3. **Виртуальные машины** - детектируются
4. **Манипуляции с Window/Navigator** - низкий вес

---

## Историческая справка

> "В 2011 году можно было зарабатывать $1000/день через AdSense с обычного Tor. Google высылал чеки по $100 автоматически. Сейчас каждый месяц - новая технология fingerprinting."

---

## Ресурсы

| Ресурс | Описание |
|--------|----------|
| DetectExpert Checker | Усечённая версия (~1500 параметров) |
| Техническая документация | В приложении к курсу |
| Исходный код чекера | Доступен на DetectExpert |

**Примечание:** Fuzzy Hashing в чекере ещё не реализован (слишком сложно).

---

## Ключевые выводы

1. **16,000 параметров** - самый большой fingerprint
2. **99.7% точность** - почти идеальная идентификация
3. **Fuzzy Hashing** - 30% изменений игнорируется
4. **9x компактнее JSON** - важно для крупных компаний
5. **Сегментированный поиск** - игнорирует отдельные ветки
6. **Шрифты важны** - устанавливайте ПО
7. **AdBlock обязателен** - признак реального пользователя
8. **Мобильные уязвимы** - особенно эффективен

---

*Транскрибировано: 2026-02-08*
*Источник: Курс Вектор Т13 по антифрод-системам*
