# 07. WebAssembly Fingerprint (WASM)

**Автор:** Вектор Т13
**Длительность:** ~13 минут
**Уровень:** Продвинутый
**Тип урока:** Новейшая технология fingerprinting

---

## Краткое содержание

WebAssembly (WASM) - виртуальная машина внутри браузера, которая выполняет код почти как нативный. WASM fingerprint определяет пользователя с точностью 99%+. Уже используется Microsoft и CyberSource. Это будущий топовый отпечаток, который затмит Canvas, WebGL и всё остальное.

---

## Ключевые тезисы

### 1. Что такое WebAssembly

| Параметр | Значение |
|----------|----------|
| Год появления | 2018 (8 лет назад) |
| Скорость | Почти как нативный код |
| Размер | Компактнее JavaScript |
| Близость к железу | Высокая |

### 2. WASM Fingerprint

| Характеристика | Значение |
|----------------|----------|
| Точность | 99%+ (погрешность <1%) |
| Определение браузера | 100% |
| Размер кода | 447 строк |
| Статус | Уже используется |

### 3. Кто использует

- **Microsoft** - первый внедрил (Microsoft Partner регистрация)
- **CyberSource** - финальная стадия внедрения
- **PerimeterX** - начальная стадия

---

## Полный конспект

### WebAssembly - новый JavaScript

#### Что это

- Язык программирования для браузеров
- Виртуальная машина внутри браузера
- Выполняется почти как нативный код
- Компилируется из C++, Rust и других языков

#### Преимущества перед JavaScript

| Параметр | JavaScript | WebAssembly |
|----------|------------|-------------|
| Скорость | Средняя | Почти нативная |
| Размер | Большой | Компактный |
| Доступ к железу | Ограниченный | Близкий |

#### Что можно запустить в браузере

- VirtualBox (условно)
- Мессенджеры
- Криптокошельки
- Любое ПО

### WASM Fingerprint - как работает

#### Принцип "пинг-понга"

```
JavaScript -> вызов -> WebAssembly
WebAssembly -> вызов -> JavaScript
... много раз туда-сюда ...
```

#### Что определяет

1. **Движок браузера** - 100% точность
2. **Виртуальные машины** - VirtualBox, VMware, etc.
3. **VPS/VDS** - серверное оборудование
4. **Серверные CPU** - другие алгоритмы вычисления
5. **Уникальный отпечаток пользователя**

### Почему это страшно

> "Canvas, WebGL и вся остальная шляпа остались в далёком прошлом. Эта технология призвана полностью изменить взгляд на антифрод-системы."

#### Подмена User-Agent бесполезна

WASM определяет **реальный** движок браузера, не то, что заявлено в User-Agent.

#### Серверы детектятся

Серверные CPU имеют другие алгоритмы вычисления:
- Intel Xeon
- AMD EPYC

Отличаются от домашних CPU:
- Intel Core
- AMD Ryzen

### Текущее внедрение

| Компания | Статус | Где используется |
|----------|--------|------------------|
| Microsoft | Активно | Partner Registration |
| CyberSource | Финальная стадия | - |
| PerimeterX | Начальная стадия | - |

**Прогноз:** Скоро появится на Amazon, PayPal и везде.

### Можно ли обойти

#### Для виртуальных машин

> "Я, как разработчик виртуальных машин, знаю какая хитрость там есть. Можно выделить пиковое количество ресурсов для браузера и обойти тест."

Но обычные пользователи этого не знают.

#### Для обычных антидетектов

На данный момент - проблема. WASM fingerprint детектит большинство решений.

### Сравнение с другими технологиями

| Технология | Когда внедрят | Статус |
|------------|---------------|--------|
| WebGPU | Сентябрь-Октябрь 2025 | Ожидается |
| **WASM** | **Уже используется** | **Активно** |

WASM станет **топовым** отпечатком, важнее:
- WebGPU
- WebRTC
- Canvas
- WebGL

---

## Технические детали

### Код чекера

- Размер: 447 строк (включая оформление)
- Язык: JavaScript + WebAssembly
- Результат: SHA-256 hash

### Механизм работы

```javascript
// Упрощённо:
1. JS вызывает WASM функцию
2. WASM выполняет вычисления
3. WASM вызывает JS callback
4. JS измеряет время/результат
5. Повторить N раз
6. Сформировать fingerprint
```

### Что влияет на отпечаток

| Фактор | Влияние |
|--------|---------|
| CPU модель | Высокое |
| Браузерный движок | Высокое |
| Виртуализация | Высокое |
| Серверный CPU vs десктопный | Высокое |
| Выделенные ресурсы | Среднее |

### Web3 и WASM

Веб3-технологии переходят с JavaScript на WebAssembly:
- Быстрее
- Безопаснее
- Ближе к железу

Это ускорит внедрение WASM fingerprinting.

---

## Ресурсы

| Ресурс | Описание |
|--------|----------|
| DetectExpert Checker | WASM fingerprint тест |
| Техническая документация | В приложении к курсу |
| Исходный код | 447 строк, доступен |

---

## Ключевые выводы

1. **WASM = виртуальная машина в браузере** - выполняет код почти нативно
2. **99%+ точность** - менее 1% погрешности
3. **Уже используется** - Microsoft, CyberSource
4. **Детектит всё** - VM, VPS, серверы, антидетекты
5. **Подмена UA бесполезна** - определяет реальный движок
6. **Будущий топ** - затмит Canvas, WebGL, WebRTC
7. **Серверные CPU палятся** - другие алгоритмы вычисления

---

## Историческая справка

> "В Tor используется расширение NoScript, которое блокирует JavaScript. Но WebAssembly - это уже не JavaScript. Это совершенно новый зверь."

---

*Транскрибировано: 2026-02-08*
*Источник: Курс Вектор Т13 по антифрод-системам*
