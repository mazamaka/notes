Приветствую, с вами Вектор Т13.
В этом уроке мы поговорим с вами о DNS.
И несмотря на то, что возможно вам покажется эта тема довольно скучной,
и вам захочется перелеснуть на следующий урок,
я прошу вас остановиться.
Дело в том, что DNS сам по себе важен абсолютно равносильно столько же,
сколько и важен ваш реальный IP-адрес.
И представим себе, что DNS и IP-адрес это костюм,
вы же не будете одевать отдельно пиджак, при этом не надев брюки.
Точно так же и в работе с DNS.
В этом уроке я расскажу вам, как правильно с ним работать,
и почему вы всегда до этого делали это неправильно.
Итак, приступаем.
На своих экранах вы видите веб-ресурс DetectExpert,
мой веб-сайт, на котором у меня один из сервисов предоставляет прокси.
Мы предоставляем прокси.
Прокси как мобильные, так и резидентные.
И за те много лет, что работает этот сервис,
самый популярный вопрос, который был от пользователей,
это что делать с DNS.
Но в случае использования мобильных адресов,
мы, конечно же, можем предоставить соединение типа OpenVPN или WireGuard,
и в таком случае DNS будет подтянут автоматически.
Но что делать, если пользователь принципиально хочет подключить прокси SOCKS?
Например, SOCKS 5.
И знаете, зачем он это хочет?
Потому что он хочет эти прокси использовать в своем антидетект-браузере,
либо в какой-либо другой программе.
И в частности, человек говорит, а какой же DNS мне выставить?
Самый популярный ответ, который пользователи дают друг другу на этот вопрос,
заключается в том, что выставь себе Google DNS и не парься.
Давайте разберемся, можно ли работать с Google DNS,
со всеми популярными DNS, общедоступными, и как это делать правильно.
Забегая вперед скажу, как я и говорил в начале этого урока,
вы никогда правильно с DNS не работали.
Приступаем.
Итак, что же сделает пользователь, когда он установит SOCKS прокси в свой антидетект-браузер,
который просто не поддерживает подключение с помощью OpenVPN или WireGuard,
он задастся вопросом, какой же DNS ему выставить.
И по факту, действительно в интернете практически нет информации,
касаемо того, какой DNS необходимо использовать.
И мы сейчас с вами об этом поговорим.
Открываем нашу схему и смотрим.
Итак, у нас есть два самых популярных варианта, которые используют пользователи.
Первый самый популярный вариант это Google DNS.
Четыре варианта.
Восьмерки.
Все прекрасно мы их знаем, эти четыре восьмерки.
Быстрый, хороший DNS.
Второй по популярности DNS это DNS от Cloudflare.
Четыре единицы.
Два самых популярных публичных DNS сервиса.
Есть также другие, такие как OpenDNS, Quad9, AdblockDNS и так далее.
Не будем сейчас заострять на них внимание.
Они слишком мелкие для нашего масштаба.
Если мы обратим внимание на статистику, то берем США.
Конкретно сейчас у меня цифры, перед вами это цифры статистики по США.
Кто хочет, можете запросить точно такую же статистику на 2024 год.
Так вот, интересной особенностью первой заключается то, что 80% всех пользователей США используют DNS от своего интернет-провайдера.
И лишь 20% используют кастомные DNS.
В моем случае мы эти 20% разделили условно на 15,5%.
Это доля Google DNS и 4,5% это доля Cloudflare DNS.
Конечно, можно было еще выделить примерно 0,2% под все остальные публичные сервисы.
Но не будем сейчас на них заострять внимание.
Будем говорить только лишь о самых-самых популярных.
Почему происходит такая большая разница?
Дело в том, что в 80%, которые принадлежат рядовым жителям США, относятся как мобильные DNS, которые предоставляются автоматически за счет оператора сотовой связи.
Также сюда относятся самые обычные DNS, которые предоставляются провайдерами Comcast, AT&T и прочими.
Дело в том, что...
что когда самый рядовой американец захотел провести себе интернет,
он не будет ковряться в модеме и выставлять себе какой-то кастомный DNS.
Ему это неинтересно, ему это не нужно.
Ему пришли, поставили модем, зачастую, причем этот модем управляется со стороны провайдера.
Иными словами, у провайдера всегда есть доступ к вашему модему,
точнее к модему данного американца, для того, чтобы произвести там любые изменения,
в том числе различного рода отражения атак, изменения хождения трафика и так далее и тому подобное.
Эта практика, кстати, является очень популярной.
Например, в Объединенных Арабских Эмиратах такой провайдер, как Do или Etisalat,
они точно также используют такую же систему.
Если мы возьмем Катар, то же самое, Бахрейн, то же самое, Саудовская Аравия, то же самое.
По Латинской Америке, Бразилия, ситуация один в один.
Выдаются модемы и роутеры, полностью прошитые под провайдера.
Во многих случаях ты не можешь даже изменить себе DNS.
Почему? Потому что это запрещено.
Плюс ко всему, не стоит забывать о таких странах, как Китай, конечно же,
и остальных странах, в которых есть необходимость фильтрации трафика.
И, к сожалению, в таких случаях DNS всегда будет отрешен.
От провайдера.
Поэтому просто так это заметим сейчас для себя.
Это не является чем-то для нас основополагающим и так далее.
Но нам нужно понимать, что когда мы собираемся использовать нашу систему для работы по США,
нам необходимо максимально мимикрировать под рядового жителя США.
И, конечно же, с каким-то кастомным DNS это сделать будет сложнее.
Но, в принципе, ничего страшного, правда?
Ну, неплохо.
Почему будем мы использовать DNS от провайдера?
Будем мы использовать, например, DNS от Google?
Ведь хорошее дело, он же все равно работает.
И, в принципе, 15,5% — это не такая маленькая цифра.
Это должно решить все наши вопросы.
Но давайте мы сейчас немного посмотрим на то, как Google DNS будет работать.
Во-первых, что касаемо Google DNS?
Есть несколько интересных фактов.
На Google DNS-сервисе никогда не проводился публичный аудит.
Иными словами, все, что у нас есть — это white papers.
То есть это у нас есть только лишь заявление от компании Google.
По факту ни один сторонний человек не знает, что происходит на этих серверах.
Да, конечно, компания Google заявляет, что мы удаляем весь IP-адрес и сохраняем только лишь его часть
для статистики, для отражения атак и так далее.
Мы сохраняем запросы пользователей.
В принципе, все очень классно.
Но, повторюсь, ни одного, ни единого аудита проведено не было.
Ну, в принципе, ладно.
Мы не являемся какими-то плохими людьми, правда?
Мы ведь всего-навсего хотим создавать, может быть, много аккаунтов в Facebook,
либо же много аккаунтов в Instagram или в Microsoft.
Ну, пусть они хранят информацию.
Правда?
Ведь никаких проблем с этим не будет.
Но!
Дело в том, что тот же самый Google в своих white papers заявляет, что они борются с бот-трафиком.
В принципе, нас это касается как-то.
Ведь мы не боты.
Так думает обычный человек.
Но давайте сравним эту ситуацию, например, с DNS от Cloudflare.
Фактически то же самое.
Но в данном случае публичный аудит у них был.
Если не ошибаюсь, это был 2022 год.
Действительно, в рамках публичного аудита не было выявлено каких-то систем сохранения информации и так далее.
Но мы с вами все взрослые люди.
И мы прекрасно понимаем, что то, что находится сейчас на DNS во время аудита,
через буквально полминуты после того, как этот аудит был закончен, может поменяться.
И по факту...
Ну...
Ты этот сервер особо не опломбируешь каким-либо образом и так далее.
То есть для того, чтобы действительно этот сервер соблюдал какие-то рамки приватности пользователей,
должна быть круглосуточная, сторонняя, третьесторонняя система наблюдения за этим сервером.
А все остальное это замыливание глаз публики.
И ничего более.
И поэтому...
Cloudflare...
Как мы знаем его, борец с DDoS-атаками, более чем интересуется выявлением ботов.
Чем это нам грозит?
Давайте мы с вами сейчас немного порассуждаем.
Дело в том, что все DNS-сервера, которые работают в США, и все интернет-провайдеры,
они обмениваются информацией между собой.
И за этими серверами...
За серверами Google, за серверами Cloudflare,
стоит несколько организаций, о которых вы вряд ли когда-либо слышали.
И вот они у нас на экране.
Итак, первая организация, которая у нас есть...
Вот она.
Messaging, Malware and Mobile Anti-Abus Working Group.
Данная компания, данное объединение, рабочая группа,
имеет совместные в блок-листы статистику и телеметрию по бот-трафику.
Сюда входят такие компании, как AT&T, Comcast, Cloudflare, Meta,
со всей их обвязкой, с всех сервисов, Microsoft и Google.
Это я перечислил только гигантов, я не стал перечислять какие-либо другие, более мелкие компании.
Окей, давайте посмотрим на вторую организацию.
Вторая организация, которая называется у нас FSISAC,
это финансовый сектор с закрытой обмен угрозами,
в том числе DNS-сигналы о ботах.
Используется банками и платёжными системами.
Такими платёжными системами, например, как Autorise,
банками как Chase, Capital One, JP Morgan
и фактически всеми-всеми-всеми.
Идём дальше.
Кто у нас ещё здесь представлен?
У нас представлена компания, которая называется APVG.
К сожалению, стрелочку к ней не провёл, но представьте, что она здесь есть.
Глобальный пул данных о фишинговых и ботнет-ресурсах.
Есть API для обмена списками для членов.
Кстати, вы можете зарегистрироваться в данной компании и ознакомиться с их API.
Сюда входят банки, интернет-провайдеры, хостинг-провайдеры,
опять же, сюда входит Google, сюда входит Microsoft,
сюда входит Apple, что интересно,
и плюс ещё некоторые антифрод-системы,
которые мы любим, такие антифрод-системы,
как, например, CyberSource и SIFT.
Ну и последняя, но не последняя по значимости,
Cyber Trade Alliance.
Обмен сигнатурами,
включая данные о ботнетах, DNS, прокси, VPN-провайдерах.
Интересно, правда?
Сюда входит Cisco, Palo Alto, Wells Fargo, PayPal,
корпорация Tesla и многие другие гиганты.
И, что ещё интереснее, самая-самая интересная фишка,
заключается в том, что данные,
союзы имеют ещё и внутренние связи между собой.
Плюс, конечно, стоит ещё упомянуть такую компанию,
такое, точнее, объединение, как AIS,
но это уже госпрограмма.
Раньше существовал такой проект,
назывался он Global Data Transfer.
Global Data Transfer позволял обмениваться информацией
между различными крупными технологическими гигантами.
В частности, когда одна компания профилируется,
например, на защите от дозиров,
великолепнейшим образом она может помочь другой компании
для того, чтобы объединить усилия в борьбе.
Ну, понятно, мир, дружба, жвачка.
Всё хорошо.
По факту, что для нас это грозит?
А я вам рассказываю.
Если ваш трафик в, например, Google DNS
был зарегистрирован как бот-трафик,
об этом узнает и CloudFlare,
об этом узнает Meta,
об этом узнает Microsoft,
об этом узнают банки
и узнает платёжная система.
Если Google пометил вас как бот-трафик,
а ведь Google, его DNS,
прекрасно видят ваш IP-адрес,
то есть IP-адрес вашего прокси
или IP-адрес вашего VPN,
и будь это самый-самый кристально чистый IP-адрес,
который вы только можете купить,
ваша активность убьёт этот IP-адрес.
При этом, знаете что?
Самое интересное, что здесь есть.
Вы убиваете прокси самостоятельно.
Но, в частности, нужно отдать должное,
вы можете эти прокси оживить.
Вот это самое прикольное, что здесь есть.
И я вам расскажу, каким образом это всё работает.
Каким образом Google
или каким образом CloudFlare
могут определить бот-трафик?
Для этого у нас есть ещё один игрок на рынке,
который называется Akamai.
Я не буду сейчас предоставлять вам документы
касаемо этого игрока,
поскольку он заслуживает отдельной лекции.
Но сейчас мы будем с вами дальше оперировать
конкретно системой идентификации пользователей,
которую использует Akamai.
И, соответственно, у нас есть все шансы предполагать,
что Google, CloudFlare и прочие DNS-сервисы,
они также используют именно эти алгоритмы.
Я сейчас вас с ними познакомлю.
Не будем уделять этому огромное внимание,
но, как я и говорил, вы сами убиваете свои прокси.
Давайте посмотрим, как это происходит.
Идём немного право.
Вот мы.
Представьте себе, вот мы.
Вот это этот великолепный пользователь,
который зашёл и где-то, неизвестно где,
приобрёл себе экстра чистые прокси.
Самые чистые выделенные прокси.
Представьте себе, что во всех чекерах,
в которых вы проверяли этот прокси,
рейтинг Фродо – ноль.
Никто этим прокси не пользовался на протяжении месяца, например.
И плюс ещё этот прокси останется на месяц дальше у вас.
То есть самый-самый чистый прокси.
Согласитесь, с такого прокси, наверное,
очень легко пойти и открыть себе банковский счёт
и зарегистрировать аккаунт Фейсбука,
либо же участвовать в партнёрской программе Майкрософт.
Все вы согласитесь со мной, правда?
Но по факту ни черта подобного.
И объясняется это вот чем.
Смотрим сюда.
Ваш прекрасный, самый чистый IP-адрес,
если он не имел никакой активности,
это очень плохо.
Во-первых.
Во-вторых, давайте посмотрим на то,
какую активность может изобразить пользователь.
Давайте сделаем так.
Вот у нас есть запросы.
Что делает пользователь после того,
как он включил этот чудесный экстра чистый прокси
в своём браузере?
Он переходит на сайт всеми известный,
на сайт BrowserLeaks.
И на этом сайте BrowserLeaks он хочет увидеть,
как же у него меняется всё-таки Canvas.
Какой он красивый, например.
Или может быть у него утекает WebRTC как вариант?
Тоже вариант.
А может быть ему вообще в голову придёт нажатие
Run DNS Leak Test?
Это самый лучший, вообще самый-самый лучший вариант.
Но давайте сейчас подумаем почему.
Итак, пользователь переходит на сайт BrowserLeaks,
чтобы проверить свои отпечатки.
Но плюс, когда он только запустил прокси,
у него его ещё антидетект браузер.
Если он сделан не совсем умным человеком,
то он даже отправит запрос на сервер лицензирования
с IP-адреса прокси.
Да, не во всех браузерах это есть.
В некоторых браузерах всё-таки сделано больше по уму.
И когда запрос лицензии,
который происходит раз в 15 минут, раз в полчаса, раз в час,
например, идёт через ваш основной канал интернета,
а не через прокси,
тогда, в принципе, номер два мы можем здесь убрать.
Но проверьте сами.
Если у вас запрос к системе лицензирования вашего браузера
идёт через прокси,
то, соответственно, он идёт, скорее всего, по доменному имени.
Поскольку IP-адрес могут,
DDoS-ить и так далее.
Поэтому, скорее всего, что будет использовано доменное имя,
в котором будет даже видно, какой антидетект браузер вы используете.
Ну, дальше, конечно же, запрос MiUnit, например.
Или же пользователь захочет со своего же проксика
зайти на сайт, например, прокси-провайдера
и изменить какую-нибудь информацию,
изменить страну или посмотреть там zip-код, например,
что-нибудь такого плана.
Иными словами,
такого рода активность
она уже подразумевает под собой
то, что этот человек не является легитимным пользователем.
И, соответственно, к нему можно присмотреться более детально.
Потому что у него уже есть первый красный флаг
это посещение подозрительных ресурсов.
Здесь нет порнхаба, здесь нет фейсбука,
здесь нет каких-то ресурсов, которые интересны людям.
Здесь только специфические ресурсы.
И поскольку все ваши запросы идут через Google DNS,
которые вы выставили в настройках своего антидетект-браузера,
либо же в настройках вашей операционной системы,
либо в настройках вашего роутера,
то Google великолепнейшим образом это все видит.
Он видит, что с вашего экстра чистого IP-адреса
пришли вот такого рода запросы.
И, соответственно, ваш экстра чистый IP-адрес
уже ставится под вопрос.
Но самое интересное находится внизу,
под этой дистрофичной стрелочкой.
Как определить, что вы используете стороннее программное обеспечение?
У вас нет запросов к Akamai сети.
У вас нет запросов к Microsoft.
У вас нет запросов к CDN сетям.
Что это означает?
А я вам сейчас дальше расскажу
подробно.
Дело в том, что ваш антидетект-браузер,
либо какое-то другое программное обеспечение,
которое используется для проксирования
того же самого браузера,
не будет расходовать трафик прокси.
Многие пользователи как раз этого боятся.
Ух, у меня уйдет там несколько лишних гигабайт,
если я буду делать проксирование на всю систему.
И здесь кроется невероятно большая сука проблема.
Если у вас будут отсутствовать вот эти три кита,
на которых держится операционная система Windows,
в данном случае мы обсуждаем,
то ваш трафик будет признан бот-трафиком
с вероятностью 100%.
Почему так происходит?
Давайте наглядно посмотрим.
Вот я сейчас запускаю программное обеспечение,
которое называется GlassWire.
Мы можем посмотреть с вами на рисунке.
Оно у нас закрылось. Один момент.
Мы можем посмотреть с вами на рисунке график трафика-рафика.
Итак, посмотрите, пожалуйста, на мою сетевую активность.
Это сейчас сетевая активность,
которая происходит с моего ПК,
когда я записываю видео.
И в данном случае у меня открыт браузер Chrome,
на котором я показываю вам диаграмму.
И открыта программа для записи видео.
Все остальные программы я не открывал лично.
Они открыты в фоне.
Если мы с вами посмотрим,
окей, Google трафик нас в принципе устраивает,
это обычный браузер.
Но вот такая вот вещь, хост-процесс.
Как вы думаете, что это?
Это Chrome. Всего-навсего.
А если у нас хост-процесса нет,
то есть если у нас, например, есть трафик просто браузера,
а подключения к данному IP-адресу у нас отсутствует,
быть может все-таки, который находится в Ирландии,
быть может все-таки это проблема в том,
что у нас не совсем тот браузер,
о котором мы заявляем.
У нас есть также какая-то активность от Anti-Kernel and System.
Давайте посмотрим, кто это такой.
Это Microsoft Windows.
Это Microsoft Windows.
Microsoft Windows имеет перманентное подключение к серверу,
это Болгария, если не ошибаюсь, наверное.
Да, это Болгария.
К вот такому вот IP-адресу в Болгарии.
Но, соответственно, подключение есть, но не по домену,
можно сказать, да? Правильно?
Вот у нас подключение идет не по домену.
То есть, в принципе, это DNS может и не видеть.
Какие у нас еще процессы? Хост-процесс.
Вот если мы сейчас смотрим на хост-процесс,
мы видим здесь дополнительно,
мы ловим здесь сразу же и Akamai.
Обращение к Akamai идет уже по доменному имени,
значит, оно идет через DNS.
Обращение к SSL.com, соответственно, тоже через DNS.
К Google, ну, это нас особо не волнует, в принципе.
DNS Google, кстати, интересный момент.
На моем компьютере сейчас не выставлен нигде DNS Google.
Вроде бы.
А может быть и выставлен.
Надо посмотреть.
По-моему, я когда показывал, да,
я для теста здесь его выставил.
Сейчас я вам расскажу чуть детальнее.
Соврал, соврал, извините.
Ну, Windows Report Problem опять же.
Смотрим.
Подключение идет через домен.
Иными словами, благодаря анализу трафика,
анализу вашего DNS трафика,
есть возможность, была еще возможность,
еще много лет назад с помощью машинного обучения
определить, что пользователь не является
реальным пользователем.
Ну, а сейчас, во времена искусственного интеллекта,
это всего-навсего пара бустяков.
Итак, какие наши основные проблемы?
Проблема первая, когда запускается,
когда запускается проксик.
Это посещение подозрительных хостов.
Проблема вторая.
Отсутствие реальных подключений к реальным запросам,
к реальным ресурсам.
Akamai, Microsoft и CDN.
CDN, кто не знает, Content Delivery Network.
CDN сети.
Благодаря этим активностям есть возможность
уже определить, что используется какое-либо
какое-либо программное обеспечение.
Не обязательно, что это может быть какой-то антидетект.
Их доля очень маленькая на рынке.
Но это может быть какой-нибудь скраппер,
кравлер и множество-множество других авлеров.
Соответственно, Google будет видеть,
что трафик с данного IP-адреса является подозрительным.
И обменяется этой информацией со всеми остальными участниками,
которые входят в данные союза,
про которые мы с вами уже обговаривали ранее.
И даже если вы не посещали, например, тот же самый ресурс Facebook,
Facebook будет уже о вас эту информацию знать.
Соответственно, как я говорил ранее,
каким образом можно отбелить данный IP-адрес.
И это действительно очень важная работа,
о которой мало кто задумывается.
Если у вас есть необходимость использовать Google DNS,
хотя мы можем от него отойти,
то самым простым вариантом будет
эта установка вашего проксика,
с которой вы хотите работать.
Например, на Raspberry Pi,
либо же на ваш роутер,
для того, чтобы через него максимально шел природный трафик.
То есть ваша операционная система,
например, ваша виртуальная машина,
будет совершать проверку обновлений,
будет совершать загрузку контента,
будет загружать и проводить все те же самые операции,
которые проводит обычный пользователь.
И соответственно, всего всего, что от вас необходимо,
всего-навсего одна вещь.
Оставить машину в покое.
И все.
Если вы хотите, чтобы ваше действие,
которое вы совершаете из этого экстра чистого IP-адреса,
принесло плоды,
в таком случае запустите прокси на всю систему
и оставьте этот прокси без какой-либо активности.
Вы будете думать, что активности по факту нет,
но в реальности она будет.
И соответственно, даже вот давайте посмотрим Telegram.
Telegram у нас, ну да, он по IP-адресу обращается.
Ладно, хрен с ним.
Steam.
Steam вот, например, общается по доменному имени.
Соответственно, что будет видеть ваш,
какую информацию в вашем IP-адресе будет видеть Google DNS?
Он будет видеть, что вы используете Steam,
он будет видеть, что вы используете браузер Google Chrome,
он будет видеть, что вы используете операционную систему Windows.
Ваш трафик является легитимным.
И все, что нужно для этого сделать?
Ничего не делать.
Просто оставить его, работать на всю систему в автономном режиме.
Самый лучший и самый простой вариант.
Ну и как я говорил, вот этот вот чудеснейший тест, проверка DNS.
Это просто самый-самый кайф, который только может существовать.
Кто делает проверку DNS, можете себе повесить на лбу табличку «Долбоеб»
и ходить с этой табличкой.
Если консоль нам сейчас поможет, мы сейчас, я вам сейчас покажу.
Ну а выводов у нас тут нету.
Если не ошибаюсь, у нас их здесь не видно.
Ну не видно и хрен с ними, правильно?
Суть.
А нет, вот есть, смотрите.
Смотрите, смотрите, смотрите.
Ну вот давайте откроем информацию.
Вот какие запросы делает сайт BrowserLeaks.
Ну, например, сайт BrowserLeaks.
Что в этих запросах общего?
Само доменное имя плюс DNS-адрес.
То есть не BrowserLeaks.com, а BrowserLeaks.org.
Они используют отдельный домен.
Они подняли там DNS-сервера, где поднимается кастомный домен.
И, соответственно, этот домен, он привязан к сессии.
И поэтому никто...
Никто до вас по этому домену не обращался.
Никто не будет обращаться.
Соответственно, когда на DNS BrowserLeaks поступит запрос,
к какому IP-адресу принадлежит такой-то, такой-то домен,
тогда BrowserLeaks может определить, с какого DNS пришел данный запрос.
И, соответственно, как мы видим, в данном случае вот у меня запрос пришел с CloudFlare,
запрос пришел с Google.
Одновременно с трех IP-адресов пришел запрос на вот это доменное имя.
Но что самое интересное происходит здесь, вы уже наверняка догадались.
Будь то CloudFlare, будь то Google, они сразу же будут знать, что используется проверка DNS.
Потому что такая активность является, во-первых, подозрительной.
Во-вторых, она, конечно же, связана с ресурсом, который занимается проверкой анонимности.
Поэтому самый красный из всех Red Flags, который можно только представить.
Так что, если вы после покупки прокси, после установки их в систему,
любите зайти на сайт BrowserLeaks и нажать кнопочку проверки,
ну, я вам сообщил, какую табличку вы можете себе на лоб повесить.
Но на этом мы не заканчиваем.
Сейчас прошла еще только половина от нашей лекции.
Давайте посмотрим дальше.
Что же делать?
Как нам поступить с нашим DNS?
Давайте посмотрим вот сюда.
Наш обычный, самый хороший DNS, который принадлежит провайдеру.
Нам нужно каким-то образом его получить.
Но несмотря на то, что он не имеет таких, конечно же, проблем в большинстве случаев, как и Google,
нужно помнить, что, как я и говорил ранее, Comcast, AT&T и другие крупные интернет-провайдеры,
они также имеют систему отлова ботов на своих DNS-серверах.
В меньшем масштабе, безусловно, использовать нативный DNS будет намного лучше, чем использование кастомных DNS.
Но все же нам нужно определить определенные проблемы, которые нам сулит использование данного IP-адреса.
И прежде чем мы перейдем к установке реального DNS и возможности, как его найти,
нам нужно обратить внимание на то, что
нативный DNS, в отличие от того же самого DNS Google или Cloudflare,
имеет под собой определенный набор метрик.
Что это за метрики?
Первая метрика, которую мы можем увидеть, это DNS Fraud Score, IP Fraud Score.
В данном случае DNS является обычным сетевым ресурсом,
и он точно также подвержен проверке, как подвержены проверки, например,
нашего IP-адреса, IP-адреса нашего прокси и так далее.
Второе. DNS Subnet Fraud Score.
В данном случае производится проверка не только IP-адреса, но и всей подсети.
Дело в том, что подсеть может быть грязная, и, соответственно,
каким бы чистым не был бы IP-адрес нашего DNS,
остальные субъекты в этой сети могут быть грязные,
и поэтому у нас будут проблемы с данным DNS-сервером.
Третье. DNS ASN Fraud Score.
Что такое ASN?
На всякий случай.
ASN, вот представим себе наш...
Где он наш? Вот он.
Вот он мой IP-адрес на текущий момент.
И здесь есть такой пункт, называется Network.
Вот он.
Переходим мы на данный пункт.
Ну, здесь в данном случае мы переходим сразу же на официальный ресурс Border Gateway протокола,
поэтому давайте мы вот этот ASN скопируем.
И перейдем мы сейчас на...
DNS-lytics.
Итак, смотрите.
ASN, автономная частная сеть.
Ранее называлась BGP, Border Gateway Protocol.
Определенный, можно так буду говорить по-простому,
определенный конгломерат IP-адресов.
Когда какое-то юридическое лицо захочет предоставлять услуги интернета на определенной области,
ему необходимо будет выделенные IP-адреса.
Соответственно, обращаются в компанию AIRIN или в компанию RIPE, как в моем случае.
И вот в 5 августа 1998 года было компании RIPE выделено 2 396 672 IP-адреса
для компании Emirates Telecommunication Group Company.
Etisalat.
Собственно говоря, мой интернет-провайдер.
У данной ASN-сети,
у данной ASN-сети есть как Fraud Score,
то есть то, о чем мы здесь говорим, вот в пункте номер 3,
так и Bot Rate, и еще и Spam Rate даже.
Есть регулярно, выходят различного рода black-листы,
в которых содержат плохие ASN-сети.
ASN-сети с бот-трафиком, ASN-сети с мошенническим трафиком, с ботнетами и так далее.
Ну и также есть более...
прогрессивные списки.
В данном случае есть организация CleanTalk.
И вот мы видим, например, статистику по различным ASN-сетям,
какое количество IP-адресов находится в этой ASN-сети
и сколько из них замечено в спам-активности.
То есть мы можем посмотреть, например, есть сети...
Вот в Индии, что интересно, есть какая-то сеть,
в которой спам-активность всего-навсего 0,9%.
Великолепная.
Ну а...
Где здесь еще?
США.
Спам-активность 35%.
Скорее всего, что данный ресурс может принадлежать
какой-либо компании, какому-нибудь дата-центру.
И мы сейчас это видим.
Кстати, интересный момент.
Вот смотрите.
В данной ASN-сети 293 425 IP-адресов.
А веб-сайтов зарегистрировано в этой сети 626 851.
И вот, что мы видим.
VPN, хостинг и хорошие боты.
Якобы.
Но давайте посмотрим сейчас на тот же самый индийский.
Где у нас вот этот индийский?
Вот, даже Индия 0,5%.
Класс.
Переходим сюда.
Здесь у нас 405 000 IP-адресов и всего-навсего 117 веб-сайтов.
За счет такого простого...
За счет такой простой сверки есть возможность определить,
является ли данная ASN-сеть хостингом,
либо же является легитимным интернет-провайдером.
Поэтому тоже важно, когда вы поднимаете свой DNS-сервер,
либо же когда используете какой-то публичный, нативный DNS-сервер,
лучше посмотреть, где этот...
В какой ASN-сети находится данный сервер.
И можно ли с него работать.
Идем дальше.
Спамрейт мы уже с вами обсудили.
DNS Anomaly.
DNS Anomaly это довольно интересный параметр,
который позволяет выявить реальное использование поддельного DNS.
Я вам сейчас расскажу.
Это будет наш следующий пункт.
Просто пока запомните.
Ну и седьмой пункт.
Называется у нас User IP.
Activity.
Бот.
Даже маленькие DNS-сервера,
которые принадлежат обычным интернет-провайдерам,
они также хотят бороться с ботами.
Бот-трафик.
Потому что бот-трафик нагружает саму сеть.
Бот-трафик создает неудобства другим пользователям и так далее.
И, в частности, есть великолепная система,
которая у нас вот здесь вот спряталась.
Называется она Google Safe Browsing.
Кстати, в ней участвует, конечно же, DNS от Google.
И также Google Safe Browsing имеет возможность коммуницировать с другими DNS-серверами,
которые к ней подключены.
Что такое Google Safe Browsing?
Google Safe Browsing в разрезе данного вопроса по-простому.
Полная передача и сдача всей информации, которой только можно.
Все.
Полное слежение за пользователем.
Ну, конечно, маскируется это под эгидой того,
что это возможность обеспечить безопасность пользователя и так далее.
Но вы сами прекрасно понимаете,
что когда вы посещаете какой-либо отель,
вы видите наверняка табличку в ванной,
в которой говорится, что данный отель, например,
очень борется за популяцию каких-нибудь синемордых пятилапых черепах
где-нибудь на Гибралтаре.
Поэтому, пожалуйста,
не смывайте свои какашки,
не бросайте полотенца на пол без нужды
и убирайте номер сами.
Желательно зубной щеткой.
Ну, примерно так.
А по факту просто-напросто владелец жлоб
и благодаря вот этой маленькой табличке
он экономит в месяц тысячи долларов
на моющих средствах, на стирке и на изношенных полотенцах.
Поэтому точно также под хорошей эгидой борьбы с этим,
с ботами маскируется самая простая и тупая слежка за пользователями.
User Activity мы с вами уже обсудили,
как это работает.
Ну что ж, сейчас у нас осталось еще две темы касаемо DNS.
Как найти свой собственный DNS под прокси
и что же может плохого приключиться с этим DNS?
Несмотря на то, что мы все уже изучили,
и так много знаем,
на самом деле есть еще важнейшая деталь,
которая позволяет пробить то, что вы используете в прокси.
Даже если по вашему DNS.
Итак, давайте обратимся сейчас к сервису от Vector T13.
Здесь на сайте DetectExpert на вкладке Checker есть чекер DNS.
Мы переходим сюда.
И теперь все, что нам нужно, нам нужно залогиниться.
Я сейчас произведу логин и через несколько секунд мы продолжим.
Не сочтите за рекламу, но я не знаю других сервисов в интернете,
которые бы выполняли такую функцию.
И эта функция нам невероятно важна.
Что же это такое?
Это возможность найти DNS сервера по вашему IP-адресу.
Давайте представим, вот как будто я использую прокси.
Мы берем наш IP-адрес,
вставляем его в DNS-чекер
и нажимаем кнопку Check.
После этого через некоторое время, обычно до 2-3 минут,
мы получим большой список DNS-серверов,
которые можно использовать с нашим IP-адресом.
Вот видите, в данном случае все прошло намного быстрее, чем 2-3 минуты.
Итак, вот мы сейчас представляем, что мы используем прокси,
и мы получили огромный список.
Список из IP-адресов.
Вот они.
Соответственно, 125 страниц.
125 страниц это примерно 12500 различных IP-адресов,
DNS-серверов, которые мы можем использовать.
Но проблема заключается в том, что далеко не все их мы можем использовать.
Поэтому, если вы начнете перебирать по одному серверу,
вы можете потратить время впустую.
Как сделать это правильно?
Мы нажимаем кнопку Копировать IP-адресы.
Нажимаем Копировать IP-адресы в буфер обмена.
И будут скопированы IP-адресы именно с той страницы, на которой вы находитесь.
Нажимаем Копировать эти IP-адресы.
И далее, все, что нам необходимо, это создать текстовый документ.
И в этом текстовом документе нам необходимо будет вставить наши IP-адреса.
Вот они.
Ровно 100 штук.
После чего, данный документ мы сохраним на рабочем столе,
и изменим его расширение с txt на расширение ini.
Итак, наш документ сохранен.
После этого мы воспользуемся бесплатной утилитой, созданной Стивом Гибсоном.
Называется утилита DNS Benchmark.
К сожалению, антивирусы могут на нее реагировать довольно плохо,
поэтому я рекомендую не переживать.
Данная утилита.
Возможно, вы захотите написать подобную утилиту.
Это, в принципе, не сложно.
Python всем в помощь.
Это не является большой проблемой.
Я буду использовать ее, как будто мы не умеем с вами программировать.
И самый простой вариант.
Данная утилита позволяет проверять DNS адреса.
Мы переходим на вкладку Name Servers и нажимаем на кнопку Add Remove.
Удаляем все Name Servers.
Удаляем все Name Servers.
Удаляем все Name Servers.
Полностью все удалили.
А теперь наша задача нажать на кнопку Add Any File Name Server.
У нас пошла загрузка и одновременно сразу же проверка наших DNS серверов.
И, что немаловажно, в данную проверку вы должны будете выполнять только тогда,
когда подключены к прокси.
Почему?
Потому что с вашего прокси коннект может быть доступен,
А с вашего прокси коннект может быть доступен,
а с другого IP-адреса другой страны коннекта может не быть.
И вот теперь ваша основная задача будет как небольшая домашняя работа.
Как будет вести себя трафик, когда мы будем проверять DNS сервера?
Он пойдет через DNS наш системный, либо же он пойдет через DNS Google,
и мы получим точно такую же проблему, про которую мы говорили ранее,
когда обращались к веб-ресурсу BrowserLeaks.
Это какой-то невероятный Red Flag с табличкой на лбу.
Вот подумайте самостоятельно и ответьте себе на этот вопрос.
Или как можно, например, сделать, чтобы правильно этот трафик пошел в момент нашей проверки.
Итак, смотрим, что мы получили в данном случае.
Из 100 серверов мы видим, что у нас есть сервера, которые подсвечены зеленым,
это сервера, которые работают.
Сервера, которые подсвечены, соответственно, красным,
это сервера, которые недоступны в нашем случае.
И мы можем сделать следующим образом.
Add remove и убрать 28 мертвых серверов.
То есть у нас было 100 серверов, 28 из них мертвые, значит 72 сервера живые.
Вы можете подключиться к любому из этих серверов
и, соответственно, использовать его в качестве DNS сервера для ваших прокси.
И это будет великолепный вариант,
с помощью которого вы не будете зависеть от Google и Cloudflare.
Это первое.
Второе, особенно если вы не находитесь ни на территории США,
потому что вот эти Red Flags, про которые я говорил,
они все характерны только для США.
Соответственно, если вы работаете, например, по Великобритании или каким-либо другим странам,
вам за это переживать не стоит.
Но стоит переживать, если вы будете использовать Public DNS,
потому что если вы будете использовать, например, работаете по Германии,
используете Google DNS,
то вы все равно получите Red Flag от Google по IP-адресу,
и, соответственно, Google сообщит в Meta, Microsoft и так далее, в другие компании,
что данный IP-адрес имеет бот-активность.
Поэтому самый лучший вариант – это использование веб-ресурса DetectExpert,
тем более чекер здесь бесплатный.
Использовать, опять же, бесплатный чекер DNS-блок,
который вы можете найти на сайте компании Gibson Research Corporation.
И таким образом вы сможете использовать огромное количество DNS-серверов.
Плюс ко всему, если вы используете, например, прокси фактически одного и того же провайдера,
то вы можете записать себе 1-2-3 этих сервера и не проводить в будущем проверку.
Если вы знаете, что вы, например, в том месте, где вы покупаете прокси,
там есть возможность выбора провайдера, сохранили себе один раз список,
и, в принципе, можете использовать один и даже тот же DNS необходимого вам провайдера,
и все будет окей.
Ну что ж, на этом мы переходим к нашей финальной части.
Финальная часть, которая позволяет веб-ресурсам определить, что вы используете прокси.
Я вам сейчас покажу очень интересную и очень сложную, на первый взгляд,
схему.
Вот она.
Что же в этой схеме такого сложного и почему она невероятно для нас важна?
Ну давайте представим себе, что это схема подключения, когда вы используете прокси SOX5.
Что происходит?
Итак, вот ваш компьютер.
На вашем компьютере вы не знаете, как установить правильный DNS.
Да?
И вы, например, не послушали мой урок.
И решили все-таки, да пошло оно все нахер.
Этот вектор ничего умного не скажет.
Я поставлю себе DNS 4 единицы, и мне будет на все насрать.
Окей.
Ваше право.
Как же, думает пользователь, пойдет трафик?
DNS работает с помощью UDP протокола.
Это мы знаем.
Нам даже сайт BrowserLeaks показывает наш реальный DNS, если мы используем SOX.
Поэтому, если мы поставим себе DNS 4 единицы, BrowserLeaks у нас покажет, что у нас используется Cloudflare,
и все будет хорошо.
Дело в шляпе.
По факту, да.
В теории.
Но в реальности это так не работает.
Когда вы поставите себе DNS 4 единицы, с помощью UDP протокола вы попадете на Cloudflare DNS.
Все окей, все классно.
Соответственно, с Cloudflare DNS вы можете загрузить необходимый вам веб-ресурс и воспользоваться UDP протоколом.
Никаких проблем нет.
Вообще.
В теории.
Но, по факту, ваш веб-ресурс может выполнить против вас сетевую атаку.
И при этом вы никогда не догадаетесь, что эта сетевая атака была выполнена.
Как работают сейчас веб-ресурсы?
Откройте уши.
Вот это атака топовая.
24 года, в 25 году ее начали применять еще чаще.
Веб-ресурс.
Не будет производить никаких атак против вас напрямую.
Но веб-ресурс будет иметь у себя определенный, например, iFrame какого-нибудь.
Или же какой-нибудь третисторонний веб-ресурс, всплывающее окно и так далее.
Иными словами, адвертайзинг.
Этот адвертайзинг будет иметь очень интересный домен.
То есть вот представьте себе, что у нас вот такой вот домен.
Ну, во-первых, в DNS Cloudflare не будет знать какой это домен, это понятное дело.
И то есть благодаря этому у веб-ресурса будет возможность определить ваш реальный DNS.
Это первое.
То есть в данном случае определится Cloudflare точно так же по аналогии с BrowserLeaks.
Ну и что в этом может быть такого, правда?
Ничего страшного.
Но на самом деле, помимо сложного домена,
есть еще...
Вот такой домен у нас будет, да?
Есть еще и сложный ответ.
А теперь немного магии.
Некоторые сетевики скажут, что это невозможно, но я рекомендую попробовать это все на практике.
Дело в том, что ваш DNS может работать как в UDP-запросе, так и в TCP-запросе.
То есть он может использовать и тот, и другой протокол.
И на TCP...
Его можно переключить искусственно.
А каким образом его можно переключить искусственно на TCP?
Если общение по UDP выходит за рамки протокола UDP.
Иными словами, UDP может обрабатывать простые запросы, но сложные запросы будет обрабатывать всегда TCP-протокол.
А соответственно, вот этот вот Advertising
может использовать...
Сложный DNS-ответ.
Сложную DNS-коммуникацию.
И таким образом инициировать подключение не по UDP-протоколу, а по TCP-протоколу.
А в данном случае, когда будет инициировано подключение по TCP-протоколу,
есть практически 90% шанса,
что будет показан DNS-протокол.
Вашего проксика.
То есть даже не ваш реальный DNS вашего провайдера,
а всего-навсего DNS-прокси.
Это страшно, как вы думаете?
Да, это страшно.
А страшно это потому, что
в UDP-запросе,
вот в этом UDP-запросе,
вот он,
вот эта система,
она получит IP-адрес UDP.
То есть в данном случае 4 единицы.
А при TCP-запросе,
она получит IP-адрес вашего сокса.
DNS вашего сокса.
Потому что трафик будет идти через него.
И соответственно, что мы получаем в сухом остатке?
В сухом остатке этот malware advertising
получит два разных IP-адреса.
IP-адрес DNS-протокола и IP-адрес TCP-протокола.
IP-адрес UDP-DNS и IP-адрес TCP-DNS.
И в том случае, если эти IP-адреса не будут совпадать,
значит используется система проксификации.
Увы и факт.
Дело в том, что
нередко можно встретить это на практике.
Почему вот я упомянул,
что некоторые сетевики могут
начать на меня матюкаться и назвать это бредом.
Дело в том, что
если ваши DNS-запросы обрабатываются
с помощью вашего
системного резольвера,
то ему будет плевать,
хоть то TCP, хоть то UDP.
И фактически, если выставлен настройка,
как DNS 4 единицы,
то он и будет использовать эти 4 единицы
хоть по TCP-протоколу, хоть по UDP-протоколу.
Но так в теории.
А по практике
ваше программное обеспечение,
ваши проксификаторы
могут блокировать TCP-протокол
для того,
чтобы не было утечки IP-адреса.
И в таком случае
TCP-запрос будет обработан
непосредственно через TCP-протокол,
поскольку
в системном резольвере он будет заблокирован,
и поэтому он пойдет
через проксификатор.
А, соответственно, Malware Advertising
сможет получить
два разных IP-адреса,
что является неконсистентным
и является DNS-аномалией,
о которой мы говорили
в пункте номер 6.
И таким образом
есть возможность определить,
что используется система проксификации.
На этом можно сказать,
что вас вычислили.
Да, конечно,
нет возможности определить
вашу реальную геопозицию таким образом.
Можно определить другим образом,
например, с помощью CDN-сетей.
Но данный веб-ресурс
снимает с себя ответственность GDPR,
он не производит никаких сетевых атак
и так далее.
А по факту даже сетевой атакой
назвать это невозможно,
потому что сканирование портов не происходит,
каких-либо методик сложных
не используется.
Просто сложное доменное имя
и используется сложный
DNS-запрос-ответ.
После этого,
после вот такой элементарно простой
организованной атаки
использование SOCKS5 или SOCKS4
к сожалению является видным.
Так что помните об этом,
не забывайте,
и если есть возможность использовать
какой-либо вид прокси,
где есть возможность полносистемного подключения
либо же виртуальные роутеры,
конечно же используйте это,
потому что в некоторых антидетектах
он касается в первую очередь
производителей антидетектов,
браузерных антидетектов,
потому что они
непосредственно больше всего уязвимы к этому.
И знаете по какой причине?
Дело в том, что вот точно так же,
как по аналогии с программным обеспечением
Proxyfire,
где есть возможность проксифицировать DNS-запросы,
точно так же в некоторых антидетектах
используется система похожая
и соответственно есть возможность
вычислить, когда пользователи
используют прокси,
поскольку антидетект браузера
не поддерживает UDP-протокол,
и соответственно UDP-протокол у вас пойдет
с системного резольвера,
а TCP-запросы пойдут уже через
непосредственно сам антидетект браузер,
где будет выявлено два разных IP-адреса,
что будет являться свидетельством того,
что пользователь использует прокси.
Большое спасибо за внимание,
с вами был VectorT13,
до встречи в следующем уроке!
